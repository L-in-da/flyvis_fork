
<!doctype html>
<html lang="en" class="no-js">
  <head>

      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">



        <link rel="canonical" href="https://flyvis.github.io/examples/init/">




      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.38">



        <title>Init - flyvis docs</title>



      <link rel="stylesheet" href="../../assets/stylesheets/main.8c3ca2c6.min.css">


        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">












        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>



      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">

      <link rel="stylesheet" href="../../style.css">

    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>






  </head>









    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple">


    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">


        <a href="#restingpotential" class="md-skip">
          Skip to content
        </a>

    </div>
    <div data-md-component="announce">

    </div>







<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="flyvis docs" class="md-header__button md-logo" aria-label="flyvis docs" data-md-component="logo">

  <img src="../../images/flyvis_logo_light@150 ppi.webp" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">

      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            flyvis docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">

              Init

          </span>
        </div>
      </div>
    </div>


        <form class="md-header__option" data-md-component="palette">




    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">

      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>





    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">

      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>





    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">

      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>


</form>



      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>



      <label class="md-header__button md-icon" for="__search">

        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">

        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>

        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">

        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">

          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>

    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>


  </nav>

</header>


    <div class="md-container" data-md-component="container">






      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">



              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">




<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="flyvis docs" class="md-nav__button md-logo" aria-label="flyvis docs" data-md-component="logo">

  <img src="../../images/flyvis_logo_light@150 ppi.webp" alt="logo">

    </a>
    flyvis docs
  </label>

  <ul class="md-nav__list" data-md-scrollfix>







    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">


  <span class="md-ellipsis">
    Home
  </span>


      </a>
    </li>









    <li class="md-nav__item">
      <a href="../../install/" class="md-nav__link">


  <span class="md-ellipsis">
    Installation
  </span>


      </a>
    </li>













    <li class="md-nav__item md-nav__item--nested">



        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >


          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">


  <span class="md-ellipsis">
    Tutorials
  </span>


            <span class="md-nav__icon md-icon"></span>
          </label>

        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>







    <li class="md-nav__item">
      <a href="../01_flyvision_connectome/" class="md-nav__link">


  <span class="md-ellipsis">
    Explore the connectome
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../02_flyvision_optic_flow_task/" class="md-nav__link">


  <span class="md-ellipsis">
    Train the network
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../03_flyvision_flash_responses/" class="md-nav__link">


  <span class="md-ellipsis">
    Flash responses
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../04_flyvision_moving_edge_responses/" class="md-nav__link">


  <span class="md-ellipsis">
    Moving edge responses
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../05_flyvision_umap_and_clustering_models/" class="md-nav__link">


  <span class="md-ellipsis">
    Ensemble clustering
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../06_flyvision_maximally_excitatory_stimuli/" class="md-nav__link">


  <span class="md-ellipsis">
    Maximally excitatory stimuli
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../07_flyvision_providing_custom_stimuli/" class="md-nav__link">


  <span class="md-ellipsis">
    Custom stimuli
  </span>


      </a>
    </li>




          </ul>
        </nav>

    </li>













    <li class="md-nav__item md-nav__item--nested">



        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >


          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">


  <span class="md-ellipsis">
    Main results
  </span>


            <span class="md-nav__icon md-icon"></span>
          </label>

        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Main results
          </label>
          <ul class="md-nav__list" data-md-scrollfix>







    <li class="md-nav__item">
      <a href="../figure_01_fly_visual_system/" class="md-nav__link">


  <span class="md-ellipsis">
    Figure 1
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../figure_02_simple_stimuli_responses/" class="md-nav__link">


  <span class="md-ellipsis">
    Figure 2
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../figure_03_naturalistic_stimuli_responses/" class="md-nav__link">


  <span class="md-ellipsis">
    Figure 3
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../figure_04_mechanisms/" class="md-nav__link">


  <span class="md-ellipsis">
    Figure 4
  </span>


      </a>
    </li>




          </ul>
        </nav>

    </li>













    <li class="md-nav__item md-nav__item--nested">



        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >


          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">


  <span class="md-ellipsis">
    API Reference
  </span>


            <span class="md-nav__icon md-icon"></span>
          </label>

        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>







    <li class="md-nav__item">
      <a href="../../reference/connectome/" class="md-nav__link">


  <span class="md-ellipsis">
    Connectome
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../../reference/network/" class="md-nav__link">


  <span class="md-ellipsis">
    Network
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../../reference/sintel/" class="md-nav__link">


  <span class="md-ellipsis">
    Sintel
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../../reference/tasks/" class="md-nav__link">


  <span class="md-ellipsis">
    Task
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../../reference/solver/" class="md-nav__link">


  <span class="md-ellipsis">
    Training
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../../reference/flash_responses/" class="md-nav__link">


  <span class="md-ellipsis">
    Flash Responses
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../../reference/moving_stimulus_responses/" class="md-nav__link">


  <span class="md-ellipsis">
    Moving Stimulus Responses
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../../reference/ensemble_clustering/" class="md-nav__link">


  <span class="md-ellipsis">
    Ensemble Clustering
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../../reference/optimal_stimuli/" class="md-nav__link">


  <span class="md-ellipsis">
    Optimal Stimuli
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../../reference/scripts/" class="md-nav__link">


  <span class="md-ellipsis">
    Scripts
  </span>


      </a>
    </li>














    <li class="md-nav__item md-nav__item--nested">



        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_11" >


          <label class="md-nav__link" for="__nav_5_11" id="__nav_5_11_label" tabindex="0">


  <span class="md-ellipsis">
    Miscelleanous
  </span>


            <span class="md-nav__icon md-icon"></span>
          </label>

        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_11">
            <span class="md-nav__icon md-icon"></span>
            Miscelleanous
          </label>
          <ul class="md-nav__list" data-md-scrollfix>







    <li class="md-nav__item">
      <a href="../../reference/rendering/" class="md-nav__link">


  <span class="md-ellipsis">
    Rendering
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../../reference/augmentation/" class="md-nav__link">


  <span class="md-ellipsis">
    Augmentation
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../../reference/datasets/" class="md-nav__link">


  <span class="md-ellipsis">
    Datasets
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../../reference/utils/" class="md-nav__link">


  <span class="md-ellipsis">
    Utils
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../../reference/visualizations/" class="md-nav__link">


  <span class="md-ellipsis">
    Visualizations
  </span>


      </a>
    </li>










    <li class="md-nav__item">
      <a href="../../reference/animations/" class="md-nav__link">


  <span class="md-ellipsis">
    Animations
  </span>


      </a>
    </li>




          </ul>
        </nav>

    </li>




          </ul>
        </nav>

    </li>









    <li class="md-nav__item">
      <a href="../../contribute/" class="md-nav__link">


  <span class="md-ellipsis">
    Contributing
  </span>


      </a>
    </li>









    <li class="md-nav__item">
      <a href="../../faq/" class="md-nav__link">


  <span class="md-ellipsis">
    FAQ
  </span>


      </a>
    </li>









    <li class="md-nav__item">
      <a href="../../acknowledgements/" class="md-nav__link">


  <span class="md-ellipsis">
    Acknowledgements
  </span>


      </a>
    </li>



  </ul>
</nav>
                  </div>
                </div>
              </div>



              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">


<nav class="md-nav md-nav--secondary" aria-label="Table of contents">






</nav>
                  </div>
                </div>
              </div>



            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">




<pre><code class="language-python">from flyvision.initialization import (
    Parameter,
    deepcopy_config,
    RestingPotential,
    TimeConstant,
    SynapseCount,
    SynapseCountScaling,
    SynapseSign,
)
from flyvision.connectome import ConnectomeDir
from datamate import Namespace
</code></pre>
<pre><code class="language-python">import pandas as pd
import torch
</code></pre>
<pre><code class="language-python">from flyvision import connectome_file
from flyvision.initialization import symmetry_mask_for_edges
</code></pre>
<pre><code class="language-python">def cast(x):
    if np.issubdtype(x.dtype, np.dtype(&quot;S&quot;)):
        return x.astype(&quot;U&quot;)
    return x
</code></pre>
<pre><code class="language-python">def get_scatter_indices(
    dataframe, grouped_dataframe, groupby
):
    &quot;&quot;&quot;Returns the grouped dataframe and the reference indices for shared parameters.

    Args:
        dataframe (pd.DataFrame): dataframe of nodes or edges, can also
                contain synapse counts and signs.
        groupby (list): list of columns to group the dataframe by.
        group (method): groupby method, e.g. first, mean, sum.

    Returns:
        pd.DataFrame: first entries per group.
        tensor: indices for parameter sharing
    &quot;&quot;&quot;
    ungrouped_elements = zip(*[dataframe[k][:] for k in groupby])
    grouped_elements = zip(*[grouped_dataframe[k][:] for k in groupby])
    to_index = {k: i for i, k in enumerate(grouped_elements)}
    return torch.tensor([to_index[k] for k in ungrouped_elements])
</code></pre>
<pre><code class="language-python">from numbers import Number
</code></pre>
<pre><code class="language-python">def byte_to_str(obj):
    if isinstance(obj, np.ndarray):
        if np.issubdtype(obj.dtype, np.dtype(&quot;S&quot;)):
            return obj.astype(&quot;U&quot;)
        return obj
    if isinstance(obj, list):
        obj = [byte_to_str(item) for item in obj]
        return obj
    elif isinstance(obj, tuple):
        obj = tuple([byte_to_str(item) for item in obj])
        return obj
    elif isinstance(obj, bytes):
        return obj.decode()
    elif isinstance(obj, (str, Number)):
        return obj
    else:
        raise TypeError
</code></pre>
<pre><code class="language-python">def compare_param(param1, param2):
    print(f&quot;comparing {param1}, {param2}&quot;)
    raw_v = (param1.raw_values == param2.raw_values).all()
    print(f&quot;raw values {raw_v}, {param2.raw_values.shape}&quot;)
    ind = (param1.indices == param2.indices).all()
    print(f&quot;indices {ind}, {param2.indices}&quot;)
    keys = byte_to_str(param1.keys) == byte_to_str(param2.keys)
    print(f&quot;keys {keys}, {np.array(param2.keys).shape}&quot;)
    masks = all([
        all([a[b].all(), a.sum() == len(b)])
        for a, b in zip(param1.symmetry_masks, param2.symmetry_masks)
    ])
    print(f&quot;masks {masks}, {len(param2.symmetry_masks)}&quot;)
    if all([raw_v, ind, keys, masks]):
        print(&quot;all passed&quot;)
        return True
    return False
</code></pre>
<pre><code class="language-python">from flyvision.initialization import InitialDistribution, symmetry_mask_for_nodes
</code></pre>
<pre><code class="language-python">import numpy as np
</code></pre>
<pre><code class="language-python">connectome = ConnectomeDir(dict(file=connectome_file, extent=15, n_syn_fill=1))
</code></pre>
<pre><code class="language-python">from typing import List
from numpy.typing import NDArray
</code></pre>
<pre><code class="language-python">np.random.normal(size=[4, 4]).astype('|S64')
</code></pre>
<pre><code>array([[b'-0.9409330618360031', b'1.0359303347565043',
        b'0.7579351187895884', b'1.4303009058439506'],
       [b'1.6960079452744552', b'0.36587744106980996',
        b'0.36973241134944446', b'-0.4087418488265296'],
       [b'0.1919436271958159', b'-0.7850875645753341',
        b'-0.6310774064104027', b'0.5065377202272231'],
       [b'1.1692414813317535', b'1.041828059256901',
        b'1.2154525911366734', b'-1.1017525548382592']], dtype='|S64')
</code></pre>
<pre><code class="language-python">def atleast_column_vector(array):
    array = np.array(array)
    if array.ndim == 1:
        return array.reshape(-1, 1)
    return array


def matrix_mask_by_sub(sub_matrix, matrix) -&gt; NDArray[bool]:
    &quot;&quot;&quot;Mask of rows in matrix that are contained in sub_matrix.

    Args:
        sub_matrix (array): shape (#rows1, #columns)
        matrix (array): shape (#rows2, #columns)

    Returns:
        array: 1D boolean array of length #rows2

    Note: #rows1 !&lt;= #rows2

    Example:
        sub_matrix = np.array([[1, 2, 3],
                                [4, 3, 1]])
        matrix = np.array([[3, 4, 1],
                            [4, 3, 1],
                            [1, 2, 3]])
        matrix_mask_by_sub(sub_matrix, matrix)
        array([False, True, True])

    Typically, indexing a tensor with indices instead of booleans is
    faster. Therefore, see also where_equal_rows.
    &quot;&quot;&quot;
    from functools import reduce

    n_rows, n_columns = sub_matrix.shape
    n_rows2 = matrix.shape[0]
    if not n_rows &lt;= n_rows2:
        raise ValueError
    row_mask = []
    for i in range(n_rows):
        column_mask = []
        for j in range(n_columns):
            column_mask.append(sub_matrix[i, j] == matrix[:, j])
        row_mask.append(reduce(np.logical_and, column_mask))
    return reduce(np.logical_or, row_mask)


def where_equal_rows(matrix1, matrix2, as_mask=False, astype='|S64') -&gt; NDArray[int]:
    &quot;&quot;&quot;Indices where matrix1 rows are in matrix2.

    Example:
        matrix1 = np.array([[1, 2, 3],
                            [4, 3, 1]])
        matrix2 = np.array([[3, 4, 1],
                            [4, 3, 1],
                            [1, 2, 3],
                            [0, 0, 0]])
        where_equal_rows(matrix1, matrix2)
        array([2, 1])
        matrix2[where_equal_rows(matrix1, matrix2)]
        array([[1, 2, 3],
               [4, 3, 1]])

    See also: matrix_mask_by_sub.
    &quot;&quot;&quot;
    matrix1 = atleast_column_vector(matrix1)
    matrix2 = atleast_column_vector(matrix2)
    matrix1 = matrix1.astype(astype)
    matrix2 = matrix2.astype(astype)

    if as_mask:
        return matrix_mask_by_sub(matrix1, matrix2)

    n_rows1, n_cols1 = matrix1.shape
    n_rows2, n_cols2 = matrix2.shape

    if not n_rows1 &lt;= n_rows2:
        raise ValueError(&quot;matrix1 must have less or&quot; &quot; equal as many rows as matrix2&quot;)
    if not n_cols1 == n_cols2:
        raise ValueError(&quot;cannot compare matrices with different number of columns&quot;)

    where = []
    rows = np.arange(matrix2.shape[0])
    for row in matrix1:
        equal_rows = (row == matrix2).all(axis=1)
        for index in rows[equal_rows]:
            where.append(index)
    return np.array(where)


def symmetry_masks(symmetric, keys, as_mask=False) -&gt; List[torch.Tensor]:
    &quot;&quot;&quot;One additional way to constrain network elements to have the same
    parameter values.

    Note, this method stores one mask per shared tuple of the size of the
    parameter and should thus be used sparsely because its not very memory
    friendly. The bulk part of parameter sharing is achieved through scatter
    and gather operations.

    Args:
        symmetric: list of tuples of cell types that share parameters.
        nodes: DataFrame containing 'cell_type' column.

    Returns:
        list of masks List[torch.BoolTensor]

    Example:
        symmetric = [[&quot;T4a&quot;, &quot;T4b&quot;, &quot;T4c&quot;, &quot;T4d&quot;], [&quot;T5a&quot;, &quot;T5b&quot;, &quot;T5c&quot;, &quot;T5d&quot;]]
        would return two masks, one to constrain all T4 subtypes to the same
        parameter and another to constrain all T5 subtypes to the same parameter.
    &quot;&quot;&quot;
    if not symmetric:
        return []
    symmetry_masks = []  # type: List[torch.Tensor]
    keys = atleast_column_vector(keys)
    for i, identifiers in enumerate(symmetric):
        identifiers = atleast_column_vector(identifiers)
        # to allow identifiers like [None, &quot;A&quot;, None, 0]
        # for parameters that have multi-keys
        columns = np.arange(identifiers.shape[1] + 1)[
            np.where((identifiers != None).all(axis=0))
        ]
        try:
            symmetry_masks.append(
                torch.tensor(
                    where_equal_rows(identifiers[:, columns],
                                     keys[:, columns], as_mask=as_mask)
                )
            )
        except Exception as e:
            raise ValueError(
                f&quot;{identifiers} cannot be a symmetry constraint&quot;
                f&quot; for parameter with keys {keys}: {e}&quot;
            ) from e
    return symmetry_masks
</code></pre>
<h1 id="restingpotential">RestingPotential</h1>
<pre><code class="language-python">config = Namespace(
                type=&quot;RestingPotential&quot;,
                groupby=[&quot;type&quot;],
                initial_dist=&quot;Normal&quot;,
                mode=&quot;sample&quot;,
                requires_grad=True,
                mean=0.5,
                std=0.05,
                penalize=Namespace(activity=True),
                seed=0,
    symmetric = [[&quot;T4a&quot;, &quot;T4b&quot;, &quot;T4c&quot;, &quot;T4d&quot;], [&quot;T5a&quot;, &quot;T5b&quot;, &quot;T5c&quot;, &quot;T5d&quot;]]
            )
</code></pre>
<pre><code class="language-python">from flyvision.initialization import Parameter
</code></pre>
<pre><code class="language-python">class RestingPotentialv2(Parameter):
    &quot;&quot;&quot;Initialize resting potentials a.k.a. biases for cell types.&quot;&quot;&quot;

    @deepcopy_config
    def __init__(self, param_config: Namespace, connectome: ConnectomeDir):
        nodes_dir = connectome.nodes

        nodes = pd.DataFrame(
            {k: byte_to_str(nodes_dir[k][:]) for k in param_config.groupby}
        )
        grouped_nodes = nodes.groupby(
            param_config.groupby, as_index=False, sort=False
        ).first()

        param_config[&quot;type&quot;] = grouped_nodes[&quot;type&quot;].values
        param_config[&quot;mean&quot;] = np.repeat(param_config[&quot;mean&quot;], len(grouped_nodes))
        param_config[&quot;std&quot;] = np.repeat(param_config[&quot;std&quot;], len(grouped_nodes))

        self.parameter = InitialDistribution(param_config)
        self.indices = get_scatter_indices(nodes, grouped_nodes, param_config.groupby)
        self.keys = param_config[&quot;type&quot;].tolist()
        self.symmetry_masks = symmetry_masks(
            param_config.get(&quot;symmetric&quot;, []), self.keys
        )
</code></pre>
<pre><code class="language-python">param = Parameter(config, connectome)
</code></pre>
<pre><code class="language-python">np.array(param.keys)[param.symmetry_masks[0].cpu().numpy()]
</code></pre>
<pre><code>array(['T4a', 'T4b', 'T4c', 'T4d'], dtype='&lt;U8')
</code></pre>
<pre><code class="language-python">config2 = Namespace(
                type=&quot;RestingPotentialv2&quot;,
                groupby=[&quot;type&quot;],
                initial_dist=&quot;Normal&quot;,
                mode=&quot;sample&quot;,
                requires_grad=True,
                mean=0.5,
                std=0.05,
                penalize=Namespace(activity=True),
                seed=0,
    symmetric = [[&quot;T4a&quot;, &quot;T4b&quot;, &quot;T4c&quot;, &quot;T4d&quot;], [&quot;T5a&quot;, &quot;T5b&quot;, &quot;T5c&quot;, &quot;T5d&quot;]]
            )
</code></pre>
<pre><code class="language-python">nodes = connectome.nodes.to_df()
</code></pre>
<pre><code class="language-python">param2 = Parameter(config2, connectome)
</code></pre>
<pre><code class="language-python">param.keys[0]
</code></pre>
<pre><code>'R1'
</code></pre>
<pre><code class="language-python">param2.symmetry_masks
</code></pre>
<pre><code>[tensor([35, 36, 37, 38]), tensor([39, 40, 41, 42])]
</code></pre>
<pre><code class="language-python">compare_param(param, param2)
</code></pre>
<pre><code>comparing RestingPotential(Namespace(
  type = 'RestingPotential',
  groupby = ['type'],
  initial_dist = 'Normal',
  mode = 'sample',
  requires_grad = True,
  mean = 0.5,
  std = 0.05,
  penalize = Namespace(activity=True),
  seed = 0,
  symmetric = [['T4a', 'T4b', 'T4c', 'T4d'], ['T5a', 'T5b', 'T5c', 'T5d']]
), ConnectomeDir), RestingPotentialv2(Namespace(
  type = 'RestingPotentialv2',
  groupby = ['type'],
  initial_dist = 'Normal',
  mode = 'sample',
  requires_grad = True,
  mean = 0.5,
  std = 0.05,
  penalize = Namespace(activity=True),
  seed = 0,
  symmetric = [['T4a', 'T4b', 'T4c', 'T4d'], ['T5a', 'T5b', 'T5c', 'T5d']]
), ConnectomeDir)
raw values True, torch.Size([65])
indices True, tensor([ 0,  0,  0,  ..., 64, 64, 64])
keys True, (65,)
masks True, 2
all passed





True
</code></pre>
<h1 id="time-constants">Time constants</h1>
<pre><code class="language-python">from flyvision.initialization import Parameter
</code></pre>
<pre><code class="language-python">class TimeConstantv2(Parameter):
    &quot;&quot;&quot;Initialize time constants for cell types.&quot;&quot;&quot;

    @deepcopy_config
    def __init__(self, param_config: Namespace, connectome: ConnectomeDir):
        nodes_dir = connectome.nodes

        nodes = pd.DataFrame({k: byte_to_str(nodes_dir[k][:]) for k in param_config.groupby})
        grouped_nodes = nodes.groupby(param_config.groupby, as_index=False, sort=False).first()

        param_config[&quot;type&quot;] = grouped_nodes[&quot;type&quot;].values
        param_config[&quot;value&quot;] = np.repeat(param_config[&quot;value&quot;], len(grouped_nodes))

        self.indices = get_scatter_indices(nodes, grouped_nodes, param_config.groupby)
        self.parameter = InitialDistribution(param_config)
        self.keys = param_config[&quot;type&quot;].tolist()
        self.symmetry_masks = symmetry_masks(
            param_config.get(&quot;symmetric&quot;, []), self.keys
        )
</code></pre>
<pre><code class="language-python">config1 = Namespace(
                type=&quot;TimeConstant&quot;,
                groupby=[&quot;type&quot;],
                initial_dist=&quot;Value&quot;,
                value=0.05,
                requires_grad=True,
        symmetric = [[&quot;T4a&quot;, &quot;T4b&quot;, &quot;T4c&quot;, &quot;T4d&quot;], [&quot;T5a&quot;, &quot;T5b&quot;, &quot;T5c&quot;, &quot;T5d&quot;]]

            )

config2 = Namespace(
                type=&quot;TimeConstantv2&quot;,
                groupby=[&quot;type&quot;],
                initial_dist=&quot;Value&quot;,
                value=0.05,
                requires_grad=True,
        symmetric = [[&quot;T4a&quot;, &quot;T4b&quot;, &quot;T4c&quot;, &quot;T4d&quot;], [&quot;T5a&quot;, &quot;T5b&quot;, &quot;T5c&quot;, &quot;T5d&quot;]]

            )
</code></pre>
<pre><code class="language-python">param = Parameter(config1, connectome)
</code></pre>
<pre><code class="language-python">param2 = Parameter(config2, connectome)
</code></pre>
<pre><code class="language-python">param2.symmetry_masks
</code></pre>
<pre><code>[tensor([35, 36, 37, 38]), tensor([39, 40, 41, 42])]
</code></pre>
<pre><code class="language-python">compare_param(param, param2)
</code></pre>
<pre><code>comparing TimeConstant(Namespace(
  type = 'TimeConstant',
  groupby = ['type'],
  initial_dist = 'Value',
  value = 0.05,
  requires_grad = True,
  symmetric = [['T4a', 'T4b', 'T4c', 'T4d'], ['T5a', 'T5b', 'T5c', 'T5d']]
), ConnectomeDir), TimeConstantv2(Namespace(
  type = 'TimeConstantv2',
  groupby = ['type'],
  initial_dist = 'Value',
  value = 0.05,
  requires_grad = True,
  symmetric = [['T4a', 'T4b', 'T4c', 'T4d'], ['T5a', 'T5b', 'T5c', 'T5d']]
), ConnectomeDir)
raw values True, torch.Size([65])
indices True, tensor([ 0,  0,  0,  ..., 64, 64, 64])
keys True, (65,)
masks True, 2
all passed





True
</code></pre>
<h1 id="synapsesign">SynapseSign</h1>
<pre><code class="language-python">class SynapseSignv2(Parameter):
    &quot;&quot;&quot;Initialize synapse signs for edge types.&quot;&quot;&quot;

    @deepcopy_config
    def __init__(self, param_config: Namespace, connectome: ConnectomeDir) -&gt; None:
        edges_dir = connectome.edges

        edges = pd.DataFrame(
            {k: byte_to_str(edges_dir[k][:]) for k in [*param_config.groupby, &quot;sign&quot;]}
        )
        grouped_edges = edges.groupby(param_config.groupby, as_index=False, sort=False).first()

        param_config.source_type = grouped_edges.source_type.values
        param_config.target_type = grouped_edges.target_type.values
        param_config.value = grouped_edges.sign.values

        self.indices = get_scatter_indices(edges, grouped_edges, param_config.groupby)
        self.parameter = InitialDistribution(param_config)
        self.keys = list(
            zip(
                param_config.source_type.tolist(),
                param_config.target_type.tolist(),
            )
        )
        self.symmetry_masks = symmetry_masks(
            param_config.get(&quot;symmetric&quot;, []), self.keys
        )
</code></pre>
<pre><code class="language-python">config = Namespace(
    type=&quot;SynapseSign&quot;,
    initial_dist=&quot;Value&quot;,
    requires_grad=False,
    groupby=[&quot;source_type&quot;, &quot;target_type&quot;],
    attributes=[&quot;sign&quot;],
    symmetric=[[(&quot;R1&quot;, &quot;L1&quot;), (&quot;R4&quot;, &quot;L1&quot;)]],
)
</code></pre>
<pre><code class="language-python">param = Parameter(config, connectome)
</code></pre>
<pre><code class="language-python">param.symmetry_masks
</code></pre>
<pre><code>[]
</code></pre>
<pre><code class="language-python">config2 = Namespace(
                type=&quot;SynapseSignv2&quot;,
                initial_dist=&quot;Value&quot;,
                requires_grad=False,
                groupby=[&quot;source_type&quot;, &quot;target_type&quot;],
                attributes=[&quot;sign&quot;],
    symmetric=[[(&quot;R1&quot;, &quot;L1&quot;),
                (&quot;R4&quot;, &quot;L1&quot;)],
              [(&quot;Mi9&quot;, &quot;T4a&quot;),
              (&quot;Mi9&quot;, &quot;T4b&quot;)]],
            )
</code></pre>
<pre><code class="language-python">param2 = Parameter(config2, connectome)
</code></pre>
<pre><code class="language-python">compare_param(param, param2)
</code></pre>
<pre><code>comparing SynapseSign(Namespace(
  type = 'SynapseSign',
  initial_dist = 'Value',
  requires_grad = False,
  groupby = ['source_type', 'target_type'],
  attributes = ['sign'],
  symmetric = [[('R1', 'L1'), ('R4', 'L1')]]
), ConnectomeDir), SynapseSignv2(Namespace(
  type = 'SynapseSignv2',
  initial_dist = 'Value',
  requires_grad = False,
  groupby = ['source_type', 'target_type'],
  attributes = ['sign'],
  symmetric = [[('R1', 'L1'), ('R4', 'L1')], [('Mi9', 'T4a'), ('Mi9', 'T4b')]]
), ConnectomeDir)
raw values True, torch.Size([604])
indices True, tensor([  0,   0,   0,  ..., 603, 603, 603])
keys True, (604, 2)
masks True, 2
all passed





True
</code></pre>
<h1 id="synapsecount">SynapseCount</h1>
<pre><code class="language-python">class SynapseCountv2(Parameter):
    &quot;&quot;&quot;Initialize synapse counts for edge types.&quot;&quot;&quot;

    @deepcopy_config
    def __init__(self, param_config: Namespace, connectome: ConnectomeDir) -&gt; None:
        mode = param_config.get(&quot;mode&quot;, &quot;&quot;)
        if mode != &quot;mean&quot;:
            raise NotImplementedError(
                f&quot;SynapseCount does not implement {mode}. Implement &quot;
                &quot;a custom Parameter subclass.&quot;
            )

        edges_dir = connectome.edges

        edges = pd.DataFrame(
            {k: byte_to_str(edges_dir[k][:]) for k in [*param_config.groupby, &quot;n_syn&quot;]}
        )
        grouped_edges = edges.groupby(
            param_config.groupby, as_index=False, sort=False
        ).mean()

        param_config.source_type = grouped_edges.source_type.values
        param_config.target_type = grouped_edges.target_type.values
        param_config.du = grouped_edges.du.values
        param_config.dv = grouped_edges.dv.values

        param_config.mode = &quot;mean&quot;
        param_config.mean = np.log(grouped_edges.n_syn.values)

        self.indices = get_scatter_indices(edges, grouped_edges, param_config.groupby)
        self.parameter = InitialDistribution(param_config)
        self.keys = list(
            zip(
                param_config.source_type.tolist(),
                param_config.target_type.tolist(),
                param_config.du.tolist(),
                param_config.dv.tolist(),
            )
        )
        self.symmetry_masks = symmetry_masks(
            param_config.get(&quot;symmetric&quot;, []), self.keys
        )

    def symmetry(self):
        keys = np.array(self.keys)
        return [keys[mask.cpu()] for mask in self.symmetry_masks]
</code></pre>
<pre><code class="language-python">config = Namespace(
                type=&quot;SynapseCount&quot;,
                initial_dist=&quot;Lognormal&quot;,
                mode=&quot;mean&quot;,
                requires_grad=False,
                std=1.0,
                groupby=[&quot;source_type&quot;, &quot;target_type&quot;, &quot;dv&quot;, &quot;du&quot;],
#         symmetric=[[(&quot;R1&quot;, &quot;L1&quot;),
#                 (&quot;R4&quot;, &quot;L1&quot;)],
#               [(&quot;Mi9&quot;, &quot;T4a&quot;),
#               (&quot;Mi9&quot;, &quot;T4b&quot;)]],
            )
</code></pre>
<pre><code class="language-python">param = Parameter(config, connectome)
</code></pre>
<pre><code class="language-python">config2 = Namespace(
    type=&quot;SynapseCountv2&quot;,
    initial_dist=&quot;Lognormal&quot;,
    mode=&quot;mean&quot;,
    requires_grad=False,
    std=1.0,
    groupby=[&quot;source_type&quot;, &quot;target_type&quot;, &quot;du&quot;, &quot;dv&quot;],
    attributes=[&quot;n_syn&quot;],
#     symmetric=[[(&quot;R1&quot;, &quot;L1&quot;),
#                 (&quot;R4&quot;, &quot;L1&quot;)],
#               [(&quot;Mi9&quot;, &quot;T4a&quot;),
#               (&quot;Mi9&quot;, &quot;T4b&quot;)],
#               [(None, None, 0, 0),
#               (None, None, 0, 0)]],
)
</code></pre>
<pre><code class="language-python">config2 = Namespace(
    type=&quot;SynapseCountv2&quot;,
    initial_dist=&quot;Lognormal&quot;,
    mode=&quot;mean&quot;,
    requires_grad=False,
    std=1.0,
    groupby=[&quot;source_type&quot;, &quot;target_type&quot;, &quot;dv&quot;, &quot;du&quot;],
    attributes=[&quot;n_syn&quot;],
    symmetric=[
        [(&quot;R2&quot;,), (&quot;R3&quot;,)],
        [(&quot;R1&quot;, &quot;L1&quot;, 0), (&quot;R4&quot;, &quot;L1&quot;, 0)],
        [(&quot;Mi9&quot;, &quot;T4a&quot;, 0, 0), (&quot;Mi9&quot;, &quot;T4b&quot;, 0, 0)],
        [(&quot;Mi9&quot;, &quot;T4a&quot;, 0, 0, 1), (&quot;Mi9&quot;, &quot;T4b&quot;, 0, 0, 1)],
    ],
)
</code></pre>
<pre><code class="language-python">param2 = Parameter(config2, connectome)
</code></pre>
<pre><code class="language-python">compare_param(param, param2)
</code></pre>
<pre><code>comparing SynapseCount(Namespace(
  type = 'SynapseCount',
  initial_dist = 'Lognormal',
  mode = 'mean',
  requires_grad = False,
  std = 1.0,
  groupby = ['source_type', 'target_type', 'dv', 'du']
), ConnectomeDir), SynapseCountv2(Namespace(
  type = 'SynapseCountv2',
  initial_dist = 'Lognormal',
  mode = 'mean',
  requires_grad = False,
  std = 1.0,
  groupby = ['source_type', 'target_type', 'du', 'dv'],
  attributes = ['n_syn']
), ConnectomeDir)
raw values True, torch.Size([2355])
indices True, tensor([   0,    0,    0,  ..., 2354, 2354, 2354])
keys True, (2355, 4)
masks True, 0
all passed





True
</code></pre>
<pre><code class="language-python">param2.symmetry()
</code></pre>
<pre><code>[array([['R1', 'L1', '0', '0'],
        ['R4', 'L1', '0', '0']], dtype='&lt;U21'),
 array([['Mi9', 'T4a', '-1', '0'],
        ['Mi9', 'T4a', '0', '1'],
        ['Mi9', 'T4a', '-1', '1'],
        ['Mi9', 'T4a', '-1', '-1'],
        ['Mi9', 'T4a', '0', '-1'],
        ['Mi9', 'T4a', '0', '-2'],
        ['Mi9', 'T4a', '1', '-2'],
        ['Mi9', 'T4a', '1', '-1'],
        ['Mi9', 'T4a', '0', '0'],
        ['Mi9', 'T4a', '2', '2'],
        ['Mi9', 'T4a', '-4', '0'],
        ['Mi9', 'T4a', '-3', '0'],
        ['Mi9', 'T4a', '-2', '-1'],
        ['Mi9', 'T4a', '-2', '0'],
        ['Mi9', 'T4a', '1', '0'],
        ['Mi9', 'T4a', '1', '1'],
        ['Mi9', 'T4b', '0', '1'],
        ['Mi9', 'T4b', '-1', '1'],
        ['Mi9', 'T4b', '-1', '2'],
        ['Mi9', 'T4b', '0', '-1'],
        ['Mi9', 'T4b', '0', '0']], dtype='&lt;U21'),
 array([['R1', 'L1', '0', '0'],
        ['R1', 'L2', '0', '0'],
        ['R1', 'L3', '0', '0'],
        ...,
        ['TmY18', 'TmY5a', '0', '0'],
        ['TmY18', 'TmY15', '0', '0'],
        ['TmY18', 'TmY18', '0', '0']], dtype='&lt;U21')]
</code></pre>
<h1 id="synapsecountscaling">SynapseCountScaling</h1>
<pre><code class="language-python">class SynapseCountScalingv2(Parameter):
    &quot;&quot;&quot;Initialize synapse count scaling for edge types.&quot;&quot;&quot;

    @deepcopy_config
    def __init__(self, param_config: Namespace, connectome: ConnectomeDir) -&gt; None:
        edges_dir = connectome.edges

        edges = pd.DataFrame(
            {
                k: byte_to_str(edges_dir[k][:])
                for k in [*param_config.groupby, &quot;n_syn&quot;]
            }
        )
        grouped_edges = edges.groupby(
            param_config.groupby, as_index=False, sort=False
        ).mean()

        # to initialize synapse strengths with 1/&lt;N&gt;_rf
        syn_strength = 1 / grouped_edges.n_syn.values  # 1/&lt;N&gt;_rf

        # scale synapse strengths of chemical and electrical synapses
        # individually
        syn_strength[grouped_edges[grouped_edges.edge_type == &quot;chem&quot;].index] *= getattr(
            param_config, &quot;scale_chem&quot;, 0.01
        )
        syn_strength[grouped_edges[grouped_edges.edge_type == &quot;elec&quot;].index] *= getattr(
            param_config, &quot;scale_elec&quot;, 0.01
        )

        param_config.target_type = grouped_edges.target_type.values
        param_config.source_type = grouped_edges.source_type.values
        param_config.value = syn_strength

        self.indices = get_scatter_indices(edges, grouped_edges, param_config.groupby)
        self.parameter = InitialDistribution(param_config)
        self.keys = list(
            zip(
                param_config.source_type.tolist(),
                param_config.target_type.tolist(),
            )
        )
        self.symmetry_masks = symmetry_masks(
            param_config.get(&quot;symmetric&quot;, []), self.keys
        )
</code></pre>
<pre><code class="language-python">config = Namespace(
                type=&quot;SynapseCountScaling&quot;,
                initial_dist=&quot;Value&quot;,
                requires_grad=True,
                scale_elec=0.01,
                scale_chem=0.01,
                clamp=&quot;non_negative&quot;,
                groupby=[&quot;source_type&quot;, &quot;target_type&quot;],
                attributes=[&quot;edge_type&quot;, &quot;n_syn&quot;],
            symmetric=[[(&quot;R1&quot;, &quot;L1&quot;),
                (&quot;R4&quot;, &quot;L1&quot;)],
              [(&quot;Mi9&quot;, &quot;T4a&quot;),
              (&quot;Mi9&quot;, &quot;T4b&quot;)]],
            )
</code></pre>
<pre><code class="language-python">param = Parameter(config, connectome)
</code></pre>
<pre><code class="language-python">config2 = Namespace(
                type=&quot;SynapseCountScalingv2&quot;,
                initial_dist=&quot;Value&quot;,
                requires_grad=True,
                scale_elec=0.01,
                scale_chem=0.01,
                clamp=&quot;non_negative&quot;,
                groupby=[&quot;source_type&quot;, &quot;target_type&quot;, &quot;edge_type&quot;],
                attributes=[&quot;n_syn&quot;],
            symmetric=[[(&quot;R1&quot;, &quot;L1&quot;),
                (&quot;R4&quot;, &quot;L1&quot;)],
              [(&quot;Mi9&quot;, &quot;T4a&quot;),
              (&quot;Mi9&quot;, &quot;T4b&quot;)]],
            )
</code></pre>
<pre><code class="language-python">compare_param(param, param2)
</code></pre>
<pre><code>comparing SynapseCountScaling(Namespace(
  type = 'SynapseCountScaling',
  initial_dist = 'Value',
  requires_grad = True,
  scale_elec = 0.01,
  scale_chem = 0.01,
  clamp = 'non_negative',
  groupby = ['source_type', 'target_type'],
  attributes = ['edge_type', 'n_syn'],
  symmetric = [[('R1', 'L1'), ('R4', 'L1')], [('Mi9', 'T4a'), ('Mi9', 'T4b')]]
), ConnectomeDir), SynapseCountScalingv2(Namespace(
  type = 'SynapseCountScalingv2',
  initial_dist = 'Value',
  requires_grad = True,
  scale_elec = 0.01,
  scale_chem = 0.01,
  clamp = 'non_negative',
  groupby = ['source_type', 'target_type', 'edge_type'],
  attributes = ['n_syn'],
  symmetric = [[('R1', 'L1'), ('R4', 'L1')], [('Mi9', 'T4a'), ('Mi9', 'T4b')]]
), ConnectomeDir)
raw values True, torch.Size([604])
indices True, tensor([  0,   0,   0,  ..., 603, 603, 603])
keys True, (604, 2)
masks False, 2





False
</code></pre>
<pre><code class="language-python">from typing import Mapping
</code></pre>
<pre><code class="language-python">
def byte_to_str(obj):
    &quot;&quot;&quot;Cast byte elements to string types.

    Note, this function is recursive and will cast all byte elements in a nested
    list or tuple.
    &quot;&quot;&quot;
    if isinstance(obj, Mapping):
        return type(obj)({k: byte_to_str(v) for k, v in obj.items()})
    elif isinstance(obj, np.ndarray):
        if np.issubdtype(obj.dtype, np.dtype(&quot;S&quot;)):
            return obj.astype(&quot;U&quot;)
        return obj
    elif isinstance(obj, list):
        obj = [byte_to_str(item) for item in obj]
        return obj
    elif isinstance(obj, tuple):
        obj = tuple([byte_to_str(item) for item in obj])
        return obj
    elif isinstance(obj, bytes):
        return obj.decode()
    elif isinstance(obj, (str, Number)):
        return obj
    else:
        raise TypeError(f&quot;can't cast {obj} of type {type(obj)} to str&quot;)
</code></pre>
<pre><code class="language-python">a = Namespace(a=Namespace(a=Namespace(a=b&quot;a&quot;)))
</code></pre>
<pre><code class="language-python">a
</code></pre>
<pre><code>Namespace(a=Namespace(a=Namespace(a=b'a')))
</code></pre>
<pre><code class="language-python">byte_to_str([[[[[(b&quot;a&quot;, b&quot;b&quot;)]]]]])
</code></pre>
<pre><code>[[[[[('a', 'b')]]]]]
</code></pre>
<pre><code class="language-python">edges = connectome.edges.to_df()
</code></pre>
<pre><code class="language-python">edges.groupby([&quot;source_type&quot;, &quot;target_type&quot;], as_index=False, sort=False).mean([&quot;n_syn&quot;])
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>source_type</th>
      <th>target_type</th>
      <th>source_u</th>
      <th>target_u</th>
      <th>n_syn</th>
      <th>du</th>
      <th>source_index</th>
      <th>dv</th>
      <th>source_v</th>
      <th>target_index</th>
      <th>target_v</th>
      <th>sign</th>
      <th>n_syn_certainty</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>R1</td>
      <td>L1</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>40.000000</td>
      <td>0.000000</td>
      <td>360.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>6128.000000</td>
      <td>0.000000</td>
      <td>-1.0</td>
      <td>5.859477</td>
    </tr>
    <tr>
      <th>1</th>
      <td>R1</td>
      <td>L2</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>46.000000</td>
      <td>0.000000</td>
      <td>360.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>6849.000000</td>
      <td>0.000000</td>
      <td>-1.0</td>
      <td>5.859477</td>
    </tr>
    <tr>
      <th>2</th>
      <td>R1</td>
      <td>L3</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>11.000000</td>
      <td>0.000000</td>
      <td>360.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>7570.000000</td>
      <td>0.000000</td>
      <td>-1.0</td>
      <td>5.859477</td>
    </tr>
    <tr>
      <th>3</th>
      <td>R1</td>
      <td>Am</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>36.000000</td>
      <td>0.000000</td>
      <td>360.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>9979.000000</td>
      <td>0.000000</td>
      <td>-1.0</td>
      <td>5.859477</td>
    </tr>
    <tr>
      <th>4</th>
      <td>R1</td>
      <td>T1</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>2.000000</td>
      <td>0.000000</td>
      <td>360.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>21515.000000</td>
      <td>0.000000</td>
      <td>-1.0</td>
      <td>5.859477</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>599</th>
      <td>TmY18</td>
      <td>T2</td>
      <td>0.244507</td>
      <td>-0.244507</td>
      <td>2.364281</td>
      <td>-0.489015</td>
      <td>45313.822112</td>
      <td>0.489015</td>
      <td>-0.244507</td>
      <td>22230.177888</td>
      <td>0.244507</td>
      <td>1.0</td>
      <td>1.587606</td>
    </tr>
    <tr>
      <th>600</th>
      <td>TmY18</td>
      <td>TmY5a</td>
      <td>-0.244507</td>
      <td>0.244507</td>
      <td>1.656361</td>
      <td>0.489015</td>
      <td>45302.177888</td>
      <td>-0.489015</td>
      <td>0.244507</td>
      <td>40987.822112</td>
      <td>-0.244507</td>
      <td>1.0</td>
      <td>5.517218</td>
    </tr>
    <tr>
      <th>601</th>
      <td>TmY18</td>
      <td>TmY9</td>
      <td>1.500000</td>
      <td>-1.500000</td>
      <td>1.000000</td>
      <td>-3.000000</td>
      <td>45344.787302</td>
      <td>2.000000</td>
      <td>-1.000000</td>
      <td>41666.212698</td>
      <td>1.000000</td>
      <td>1.0</td>
      <td>2.782612</td>
    </tr>
    <tr>
      <th>602</th>
      <td>TmY18</td>
      <td>TmY15</td>
      <td>-0.220461</td>
      <td>0.220461</td>
      <td>2.230947</td>
      <td>0.440922</td>
      <td>45302.296781</td>
      <td>0.426213</td>
      <td>-0.213107</td>
      <td>44592.703219</td>
      <td>0.213107</td>
      <td>1.0</td>
      <td>0.864511</td>
    </tr>
    <tr>
      <th>603</th>
      <td>TmY18</td>
      <td>TmY18</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.292609</td>
      <td>0.000000</td>
      <td>45308.099109</td>
      <td>-0.198219</td>
      <td>0.099109</td>
      <td>45307.900891</td>
      <td>-0.099109</td>
      <td>1.0</td>
      <td>2.239571</td>
    </tr>
  </tbody>
</table>
<p>604 rows × 13 columns</p>
</div>
<pre><code class="language-python">edges.columns
</code></pre>
<pre><code>Index(['source_u', 'target_u', 'n_syn', 'du', 'source_type', 'target_type',
       'edge_type', 'source_index', 'dv', 'source_v', 'target_index',
       'target_v', 'sign', 'n_syn_certainty'],
      dtype='object')
</code></pre>
<pre><code class="language-python">edges
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>source_u</th>
      <th>target_u</th>
      <th>n_syn</th>
      <th>du</th>
      <th>source_type</th>
      <th>target_type</th>
      <th>edge_type</th>
      <th>source_index</th>
      <th>dv</th>
      <th>source_v</th>
      <th>target_index</th>
      <th>target_v</th>
      <th>sign</th>
      <th>n_syn_certainty</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-15</td>
      <td>-15</td>
      <td>40.0</td>
      <td>0</td>
      <td>R1</td>
      <td>L1</td>
      <td>chem</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5768</td>
      <td>0</td>
      <td>-1.0</td>
      <td>5.859477</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-15</td>
      <td>-15</td>
      <td>40.0</td>
      <td>0</td>
      <td>R1</td>
      <td>L1</td>
      <td>chem</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>5769</td>
      <td>1</td>
      <td>-1.0</td>
      <td>5.859477</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-15</td>
      <td>-15</td>
      <td>40.0</td>
      <td>0</td>
      <td>R1</td>
      <td>L1</td>
      <td>chem</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>5770</td>
      <td>2</td>
      <td>-1.0</td>
      <td>5.859477</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-15</td>
      <td>-15</td>
      <td>40.0</td>
      <td>0</td>
      <td>R1</td>
      <td>L1</td>
      <td>chem</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>5771</td>
      <td>3</td>
      <td>-1.0</td>
      <td>5.859477</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-15</td>
      <td>-15</td>
      <td>40.0</td>
      <td>0</td>
      <td>R1</td>
      <td>L1</td>
      <td>chem</td>
      <td>4</td>
      <td>0</td>
      <td>4</td>
      <td>5772</td>
      <td>4</td>
      <td>-1.0</td>
      <td>5.859477</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1513226</th>
      <td>15</td>
      <td>15</td>
      <td>1.0</td>
      <td>0</td>
      <td>TmY18</td>
      <td>TmY18</td>
      <td>chem</td>
      <td>45664</td>
      <td>0</td>
      <td>-4</td>
      <td>45664</td>
      <td>-4</td>
      <td>1.0</td>
      <td>2.239571</td>
    </tr>
    <tr>
      <th>1513227</th>
      <td>15</td>
      <td>15</td>
      <td>1.0</td>
      <td>0</td>
      <td>TmY18</td>
      <td>TmY18</td>
      <td>chem</td>
      <td>45665</td>
      <td>0</td>
      <td>-3</td>
      <td>45665</td>
      <td>-3</td>
      <td>1.0</td>
      <td>2.239571</td>
    </tr>
    <tr>
      <th>1513228</th>
      <td>15</td>
      <td>15</td>
      <td>1.0</td>
      <td>0</td>
      <td>TmY18</td>
      <td>TmY18</td>
      <td>chem</td>
      <td>45666</td>
      <td>0</td>
      <td>-2</td>
      <td>45666</td>
      <td>-2</td>
      <td>1.0</td>
      <td>2.239571</td>
    </tr>
    <tr>
      <th>1513229</th>
      <td>15</td>
      <td>15</td>
      <td>1.0</td>
      <td>0</td>
      <td>TmY18</td>
      <td>TmY18</td>
      <td>chem</td>
      <td>45667</td>
      <td>0</td>
      <td>-1</td>
      <td>45667</td>
      <td>-1</td>
      <td>1.0</td>
      <td>2.239571</td>
    </tr>
    <tr>
      <th>1513230</th>
      <td>15</td>
      <td>15</td>
      <td>1.0</td>
      <td>0</td>
      <td>TmY18</td>
      <td>TmY18</td>
      <td>chem</td>
      <td>45668</td>
      <td>0</td>
      <td>0</td>
      <td>45668</td>
      <td>0</td>
      <td>1.0</td>
      <td>2.239571</td>
    </tr>
  </tbody>
</table>
<p>1513231 rows × 14 columns</p>
</div>

<pre><code class="language-python">elements = [&quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;B&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;, &quot;D&quot;, &quot;E&quot;]
groups = [&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;, &quot;E&quot;]
parameter = [1, 2, 3, 4, 5]
# get_scatter_indices would return
scatter_indices = [0, 0, 0, 1, 1, 2, 3, 3, 4]
scattered_parameters = [parameter[idx] for idx in scatter_indices]
</code></pre>
<pre><code class="language-python">scattered_parameters
</code></pre>
<pre><code>[1, 1, 1, 2, 2, 3, 4, 4, 5]
</code></pre>
<pre><code class="language-python">param2.keys
</code></pre>
<pre><code>[('R1', 'L1'),
 ('R1', 'L2'),
 ('R1', 'L3'),
 ('R1', 'Am'),
 ('R1', 'T1'),
 ('R2', 'L1'),
 ('R2', 'L2'),
 ('R2', 'L3'),
 ('R2', 'Am'),
 ('R2', 'T1'),
 ('R3', 'L1'),
 ('R3', 'L2'),
 ('R3', 'L3'),
 ('R3', 'Am'),
 ('R3', 'T1'),
 ('R4', 'L1'),
 ('R4', 'L2'),
 ('R4', 'L3'),
 ('R4', 'Am'),
 ('R4', 'T1'),
 ('R5', 'L1'),
 ('R5', 'L2'),
 ('R5', 'L3'),
 ('R5', 'Am'),
 ('R5', 'T1'),
 ('R6', 'L1'),
 ('R6', 'L2'),
 ('R6', 'L3'),
 ('R6', 'Am'),
 ('R6', 'T1'),
 ('R7', 'R8'),
 ('R7', 'Mi9'),
 ('R7', 'Mi15'),
 ('R7', 'Tm5a'),
 ('R7', 'Tm5b'),
 ('R8', 'R7'),
 ('R8', 'L1'),
 ('R8', 'L3'),
 ('R8', 'Mi1'),
 ('R8', 'Mi4'),
 ('R8', 'Mi9'),
 ('R8', 'Mi15'),
 ('R8', 'Tm5c'),
 ('R8', 'Tm20'),
 ('L1', 'L5'),
 ('L1', 'Lawf2'),
 ('L1', 'C2'),
 ('L1', 'C3'),
 ('L1', 'Mi1'),
 ('L1', 'Tm3'),
 ('L2', 'R1'),
 ('L2', 'R2'),
 ('L2', 'L1'),
 ('L2', 'L4'),
 ('L2', 'L5'),
 ('L2', 'Lawf2'),
 ('L2', 'C3'),
 ('L2', 'Mi1'),
 ('L2', 'Mi4'),
 ('L2', 'Mi9'),
 ('L2', 'T1'),
 ('L2', 'Tm1'),
 ('L2', 'Tm2'),
 ('L2', 'Tm4'),
 ('L2', 'Tm20'),
 ('L2', 'TmY3'),
 ('L3', 'Lawf1'),
 ('L3', 'C3'),
 ('L3', 'Mi1'),
 ('L3', 'Mi2'),
 ('L3', 'Mi9'),
 ('L3', 'Mi13'),
 ('L3', 'Mi15'),
 ('L3', 'Tm3'),
 ('L3', 'Tm5Y'),
 ('L3', 'Tm5a'),
 ('L3', 'Tm5c'),
 ('L3', 'Tm9'),
 ('L3', 'Tm20'),
 ('L3', 'Tm28'),
 ('L3', 'TmY9'),
 ('L3', 'TmY10'),
 ('L4', 'R1'),
 ('L4', 'R2'),
 ('L4', 'R3'),
 ('L4', 'R4'),
 ('L4', 'R5'),
 ('L4', 'R6'),
 ('L4', 'L2'),
 ('L4', 'L3'),
 ('L4', 'L4'),
 ('L4', 'L5'),
 ('L4', 'Am'),
 ('L4', 'Mi9'),
 ('L4', 'T2'),
 ('L4', 'Tm2'),
 ('L4', 'Tm4'),
 ('L4', 'Tm9'),
 ('L4', 'TmY3'),
 ('L4', 'TmY13'),
 ('L5', 'L1'),
 ('L5', 'L2'),
 ('L5', 'L5'),
 ('L5', 'C2'),
 ('L5', 'C3'),
 ('L5', 'Mi1'),
 ('L5', 'Mi2'),
 ('L5', 'Mi4'),
 ('L5', 'Mi15'),
 ('L5', 'T1'),
 ('L5', 'T2'),
 ('L5', 'Tm3'),
 ('L5', 'Tm20'),
 ('L5', 'TmY3'),
 ('L5', 'TmY13'),
 ('L5', 'TmY14'),
 ('L5', 'TmY18'),
 ('Lawf1', 'Tm3'),
 ('Lawf2', 'L3'),
 ('Lawf2', 'Lawf2'),
 ('Lawf2', 'Am'),
 ('Am', 'R1'),
 ('Am', 'R2'),
 ('Am', 'R4'),
 ('Am', 'R5'),
 ('Am', 'L1'),
 ('Am', 'L2'),
 ('Am', 'L3'),
 ('Am', 'L4'),
 ('Am', 'C2'),
 ('Am', 'C3'),
 ('Am', 'T1'),
 ('C2', 'L1'),
 ('C2', 'L2'),
 ('C2', 'L3'),
 ('C2', 'L4'),
 ('C2', 'L5'),
 ('C2', 'Lawf2'),
 ('C2', 'Am'),
 ('C2', 'Mi1'),
 ('C2', 'T1'),
 ('C2', 'T2'),
 ('C2', 'T4a'),
 ('C2', 'Tm1'),
 ('C2', 'Tm9'),
 ('C2', 'TmY14'),
 ('C3', 'R3'),
 ('C3', 'L1'),
 ('C3', 'L2'),
 ('C3', 'L3'),
 ('C3', 'L5'),
 ('C3', 'Lawf2'),
 ('C3', 'Am'),
 ('C3', 'CT1(M10)'),
 ('C3', 'Mi1'),
 ('C3', 'Mi4'),
 ('C3', 'Mi9'),
 ('C3', 'T1'),
 ('C3', 'T2'),
 ('C3', 'T4a'),
 ('C3', 'T4b'),
 ('C3', 'T4c'),
 ('C3', 'T4d'),
 ('C3', 'Tm1'),
 ('C3', 'Tm2'),
 ('C3', 'Tm4'),
 ('C3', 'Tm9'),
 ('C3', 'Tm20'),
 ('CT1(Lo1)', 'T5a'),
 ('CT1(Lo1)', 'T5b'),
 ('CT1(Lo1)', 'T5c'),
 ('CT1(Lo1)', 'T5d'),
 ('CT1(Lo1)', 'Tm1'),
 ('CT1(Lo1)', 'Tm9'),
 ('CT1(M10)', 'C3'),
 ('CT1(M10)', 'Mi1'),
 ('CT1(M10)', 'T4a'),
 ('CT1(M10)', 'T4b'),
 ('CT1(M10)', 'T4c'),
 ('CT1(M10)', 'T4d'),
 ('Mi1', 'L1'),
 ('Mi1', 'L5'),
 ('Mi1', 'C2'),
 ('Mi1', 'C3'),
 ('Mi1', 'CT1(M10)'),
 ('Mi1', 'Mi2'),
 ('Mi1', 'Mi4'),
 ('Mi1', 'Mi9'),
 ('Mi1', 'Mi10'),
 ('Mi1', 'Mi12'),
 ('Mi1', 'Mi13'),
 ('Mi1', 'Mi14'),
 ('Mi1', 'Mi15'),
 ('Mi1', 'T2'),
 ('Mi1', 'T2a'),
 ('Mi1', 'T3'),
 ('Mi1', 'T4a'),
 ('Mi1', 'T4b'),
 ('Mi1', 'T4c'),
 ('Mi1', 'T4d'),
 ('Mi1', 'Tm1'),
 ('Mi1', 'Tm3'),
 ('Mi1', 'Tm20'),
 ('Mi1', 'TmY3'),
 ('Mi1', 'TmY9'),
 ('Mi1', 'TmY13'),
 ('Mi1', 'TmY14'),
 ('Mi1', 'TmY15'),
 ('Mi1', 'TmY18'),
 ('Mi2', 'Mi1'),
 ('Mi2', 'T2'),
 ('Mi2', 'T2a'),
 ('Mi2', 'T3'),
 ('Mi2', 'Tm1'),
 ('Mi2', 'TmY18'),
 ('Mi3', 'T2'),
 ('Mi3', 'Tm5b'),
 ('Mi4', 'L2'),
 ('Mi4', 'C3'),
 ('Mi4', 'Mi1'),
 ('Mi4', 'Mi4'),
 ('Mi4', 'Mi9'),
 ('Mi4', 'T1'),
 ('Mi4', 'T4a'),
 ('Mi4', 'T4b'),
 ('Mi4', 'T4c'),
 ('Mi4', 'T4d'),
 ('Mi4', 'Tm1'),
 ('Mi4', 'Tm2'),
 ('Mi4', 'Tm5Y'),
 ('Mi4', 'Tm5a'),
 ('Mi4', 'Tm5b'),
 ('Mi4', 'Tm5c'),
 ('Mi4', 'Tm9'),
 ('Mi4', 'Tm16'),
 ('Mi4', 'Tm20'),
 ('Mi4', 'Tm28'),
 ('Mi4', 'TmY3'),
 ('Mi4', 'TmY4'),
 ('Mi4', 'TmY5a'),
 ('Mi4', 'TmY10'),
 ('Mi4', 'TmY13'),
 ('Mi4', 'TmY15'),
 ('Mi4', 'TmY18'),
 ('Mi9', 'L3'),
 ('Mi9', 'Lawf1'),
 ('Mi9', 'C3'),
 ('Mi9', 'CT1(M10)'),
 ('Mi9', 'Mi1'),
 ('Mi9', 'Mi4'),
 ('Mi9', 'Mi10'),
 ('Mi9', 'Mi15'),
 ('Mi9', 'T2'),
 ('Mi9', 'T2a'),
 ('Mi9', 'T4a'),
 ('Mi9', 'T4b'),
 ('Mi9', 'T4c'),
 ('Mi9', 'T4d'),
 ('Mi9', 'Tm1'),
 ('Mi9', 'Tm2'),
 ('Mi9', 'Tm4'),
 ('Mi9', 'Tm5a'),
 ('Mi9', 'Tm5b'),
 ('Mi9', 'Tm16'),
 ('Mi9', 'TmY3'),
 ('Mi9', 'TmY4'),
 ('Mi9', 'TmY5a'),
 ('Mi9', 'TmY13'),
 ('Mi9', 'TmY18'),
 ('Mi10', 'Lawf1'),
 ('Mi10', 'Mi9'),
 ('Mi10', 'Mi14'),
 ('Mi10', 'T4a'),
 ('Mi10', 'T4b'),
 ('Mi10', 'T4c'),
 ('Mi10', 'T4d'),
 ('Mi10', 'Tm5b'),
 ('Mi10', 'TmY3'),
 ('Mi10', 'TmY5a'),
 ('Mi10', 'TmY14'),
 ('Mi12', 'Mi1'),
 ('Mi12', 'Mi9'),
 ('Mi12', 'Tm1'),
 ('Mi12', 'Tm2'),
 ('Mi12', 'Tm3'),
 ('Mi12', 'Tm4'),
 ('Mi13', 'L5'),
 ('Mi13', 'Mi1'),
 ('Mi13', 'T2'),
 ('Mi13', 'Tm1'),
 ('Mi13', 'Tm2'),
 ('Mi13', 'Tm3'),
 ('Mi13', 'Tm4'),
 ('Mi13', 'Tm9'),
 ('Mi14', 'Tm1'),
 ('Mi14', 'Tm4'),
 ('Mi14', 'TmY3'),
 ('Mi15', 'C3'),
 ('Mi15', 'Mi4'),
 ('Mi15', 'Mi10'),
 ('Mi15', 'Mi15'),
 ('Mi15', 'Tm5c'),
 ('T1', 'L2'),
 ('T1', 'L5'),
 ('T1', 'Tm20'),
 ('T2', 'Lawf2'),
 ('T2', 'Mi1'),
 ('T2', 'T2'),
 ('T2', 'Tm5c'),
 ('T2', 'TmY5a'),
 ('T2', 'TmY15'),
 ('T2a', 'Mi1'),
 ('T2a', 'T3'),
 ('T2a', 'Tm3'),
 ('T2a', 'Tm5Y'),
 ('T2a', 'Tm5b'),
 ('T2a', 'Tm28'),
 ('T2a', 'TmY4'),
 ('T2a', 'TmY5a'),
 ('T2a', 'TmY9'),
 ('T3', 'T2'),
 ('T3', 'T2a'),
 ('T3', 'Tm3'),
 ('T4a', 'C3'),
 ('T4a', 'CT1(M10)'),
 ('T4a', 'Mi9'),
 ('T4a', 'Mi12'),
 ('T4a', 'T4a'),
 ('T4a', 'T4c'),
 ('T4a', 'T5a'),
 ('T4a', 'TmY14'),
 ('T4a', 'TmY18'),
 ('T4b', 'CT1(M10)'),
 ('T4b', 'Mi9'),
 ('T4b', 'T4b'),
 ('T4b', 'T4c'),
 ('T4b', 'T5b'),
 ('T4b', 'TmY15'),
 ('T4c', 'CT1(M10)'),
 ('T4c', 'Mi9'),
 ('T4c', 'T4c'),
 ('T4c', 'T5c'),
 ('T4c', 'TmY4'),
 ('T4c', 'TmY14'),
 ('T4c', 'TmY15'),
 ('T4d', 'CT1(M10)'),
 ('T4d', 'T4a'),
 ('T4d', 'T4d'),
 ('T4d', 'T5d'),
 ('T4d', 'TmY4'),
 ('T4d', 'TmY15'),
 ('T5a', 'CT1(Lo1)'),
 ('T5a', 'T4a'),
 ('T5a', 'T5a'),
 ('T5a', 'T5b'),
 ('T5a', 'TmY9'),
 ('T5a', 'TmY14'),
 ('T5a', 'TmY15'),
 ('T5b', 'CT1(Lo1)'),
 ('T5b', 'T2'),
 ('T5b', 'T4b'),
 ('T5b', 'T5b'),
 ('T5b', 'T5d'),
 ('T5b', 'Tm2'),
 ('T5b', 'TmY14'),
 ('T5b', 'TmY15'),
 ('T5c', 'CT1(Lo1)'),
 ('T5c', 'T4c'),
 ('T5c', 'T5c'),
 ('T5c', 'Tm2'),
 ('T5c', 'TmY4'),
 ('T5c', 'TmY14'),
 ('T5c', 'TmY15'),
 ('T5d', 'CT1(Lo1)'),
 ('T5d', 'T2'),
 ('T5d', 'T4d'),
 ('T5d', 'T5d'),
 ('T5d', 'TmY4'),
 ('T5d', 'TmY15'),
 ('Tm1', 'L2'),
 ('Tm1', 'L5'),
 ('Tm1', 'Lawf2'),
 ('Tm1', 'C3'),
 ('Tm1', 'CT1(Lo1)'),
 ('Tm1', 'Mi1'),
 ('Tm1', 'Mi2'),
 ('Tm1', 'Mi4'),
 ('Tm1', 'Mi9'),
 ('Tm1', 'Mi12'),
 ('Tm1', 'Mi13'),
 ('Tm1', 'T1'),
 ('Tm1', 'T2'),
 ('Tm1', 'T2a'),
 ('Tm1', 'T3'),
 ('Tm1', 'T5a'),
 ('Tm1', 'T5b'),
 ('Tm1', 'T5c'),
 ('Tm1', 'T5d'),
 ('Tm1', 'Tm2'),
 ('Tm1', 'Tm4'),
 ('Tm1', 'Tm5Y'),
 ('Tm1', 'Tm9'),
 ('Tm1', 'Tm20'),
 ('Tm1', 'Tm28'),
 ('Tm1', 'TmY4'),
 ('Tm1', 'TmY9'),
 ('Tm1', 'TmY15'),
 ('Tm2', 'L2'),
 ('Tm2', 'L5'),
 ('Tm2', 'Lawf1'),
 ('Tm2', 'C3'),
 ('Tm2', 'CT1(Lo1)'),
 ('Tm2', 'Mi4'),
 ('Tm2', 'Mi9'),
 ('Tm2', 'T2'),
 ('Tm2', 'T2a'),
 ('Tm2', 'T5a'),
 ('Tm2', 'T5b'),
 ('Tm2', 'T5c'),
 ('Tm2', 'T5d'),
 ('Tm2', 'Tm1'),
 ('Tm2', 'Tm4'),
 ('Tm2', 'Tm9'),
 ('Tm2', 'Tm28'),
 ('Tm2', 'TmY3'),
 ('Tm2', 'TmY4'),
 ('Tm2', 'TmY13'),
 ('Tm2', 'TmY15'),
 ('Tm2', 'TmY18'),
 ('Tm3', 'L1'),
 ('Tm3', 'Lawf1'),
 ('Tm3', 'Lawf2'),
 ('Tm3', 'Mi1'),
 ('Tm3', 'Mi11'),
 ('Tm3', 'Mi14'),
 ('Tm3', 'T2'),
 ('Tm3', 'T2a'),
 ('Tm3', 'T3'),
 ('Tm3', 'T4a'),
 ('Tm3', 'T4b'),
 ('Tm3', 'T4c'),
 ('Tm3', 'T4d'),
 ('Tm3', 'Tm3'),
 ('Tm3', 'Tm4'),
 ('Tm3', 'Tm30'),
 ('Tm3', 'TmY3'),
 ('Tm3', 'TmY5a'),
 ('Tm3', 'TmY13'),
 ('Tm3', 'TmY14'),
 ('Tm3', 'TmY15'),
 ('Tm3', 'TmY18'),
 ('Tm4', 'Lawf2'),
 ('Tm4', 'C3'),
 ('Tm4', 'Mi4'),
 ('Tm4', 'Mi10'),
 ('Tm4', 'Mi12'),
 ('Tm4', 'Mi13'),
 ('Tm4', 'Mi14'),
 ('Tm4', 'T2'),
 ('Tm4', 'T2a'),
 ('Tm4', 'T3'),
 ('Tm4', 'T5a'),
 ('Tm4', 'T5b'),
 ('Tm4', 'T5c'),
 ('Tm4', 'T5d'),
 ('Tm4', 'Tm3'),
 ('Tm4', 'Tm4'),
 ('Tm4', 'TmY3'),
 ('Tm4', 'TmY4'),
 ('Tm4', 'TmY5a'),
 ('Tm4', 'TmY13'),
 ('Tm4', 'TmY14'),
 ('Tm4', 'TmY15'),
 ('Tm5Y', 'Tm5a'),
 ('Tm5Y', 'Tm5b'),
 ('Tm5Y', 'Tm20'),
 ('Tm5Y', 'TmY5a'),
 ('Tm5Y', 'TmY10'),
 ('Tm5a', 'Tm5a'),
 ('Tm5a', 'Tm5b'),
 ('Tm5b', 'Mi3'),
 ('Tm5b', 'Mi10'),
 ('Tm5b', 'Tm5a'),
 ('Tm5b', 'Tm5b'),
 ('Tm5b', 'Tm5c'),
 ('Tm5c', 'Mi4'),
 ('Tm5c', 'Mi15'),
 ('Tm5c', 'Tm5Y'),
 ('Tm5c', 'Tm5b'),
 ('Tm5c', 'Tm16'),
 ('Tm9', 'CT1(Lo1)'),
 ('Tm9', 'Mi9'),
 ('Tm9', 'T5a'),
 ('Tm9', 'T5b'),
 ('Tm9', 'T5c'),
 ('Tm9', 'T5d'),
 ('Tm9', 'Tm1'),
 ('Tm9', 'Tm2'),
 ('Tm9', 'Tm5Y'),
 ('Tm9', 'Tm28'),
 ('Tm9', 'TmY4'),
 ('Tm9', 'TmY9'),
 ('Tm9', 'TmY15'),
 ('Tm16', 'Lawf1'),
 ('Tm16', 'Lawf2'),
 ('Tm16', 'Mi9'),
 ('Tm16', 'T2'),
 ('Tm16', 'Tm1'),
 ('Tm16', 'Tm2'),
 ('Tm16', 'Tm4'),
 ('Tm16', 'Tm5Y'),
 ('Tm16', 'Tm5c'),
 ('Tm16', 'Tm9'),
 ('Tm16', 'TmY3'),
 ('Tm16', 'TmY5a'),
 ('Tm16', 'TmY10'),
 ('Tm16', 'TmY13'),
 ('Tm16', 'TmY14'),
 ('Tm20', 'Mi2'),
 ('Tm20', 'Mi9'),
 ('Tm20', 'Tm5Y'),
 ('Tm20', 'Tm9'),
 ('Tm20', 'Tm20'),
 ('Tm28', 'Tm5Y'),
 ('Tm28', 'TmY4'),
 ('Tm28', 'TmY9'),
 ('TmY3', 'T2'),
 ('TmY3', 'Tm4'),
 ('TmY3', 'TmY3'),
 ('TmY3', 'TmY4'),
 ('TmY3', 'TmY5a'),
 ('TmY3', 'TmY13'),
 ('TmY3', 'TmY14'),
 ('TmY3', 'TmY15'),
 ('TmY4', 'Mi3'),
 ('TmY4', 'Mi4'),
 ('TmY4', 'Mi13'),
 ('TmY4', 'T2'),
 ('TmY4', 'T5d'),
 ('TmY4', 'TmY4'),
 ('TmY4', 'TmY5a'),
 ('TmY4', 'TmY9'),
 ('TmY4', 'TmY14'),
 ('TmY5a', 'Mi2'),
 ('TmY5a', 'Mi3'),
 ('TmY5a', 'T2'),
 ('TmY5a', 'T2a'),
 ('TmY5a', 'Tm16'),
 ('TmY5a', 'TmY3'),
 ('TmY5a', 'TmY4'),
 ('TmY5a', 'TmY14'),
 ('TmY5a', 'TmY15'),
 ('TmY5a', 'TmY18'),
 ('TmY9', 'Mi13'),
 ('TmY9', 'TmY4'),
 ('TmY9', 'TmY9'),
 ('TmY10', 'Mi4'),
 ('TmY10', 'T2a'),
 ('TmY10', 'Tm5b'),
 ('TmY10', 'Tm5c'),
 ('TmY10', 'Tm9'),
 ('TmY10', 'Tm16'),
 ('TmY10', 'Tm20'),
 ('TmY10', 'Tm28'),
 ('TmY10', 'TmY4'),
 ('TmY10', 'TmY9'),
 ('TmY13', 'Mi4'),
 ('TmY13', 'T2'),
 ('TmY13', 'Tm5b'),
 ('TmY13', 'Tm16'),
 ('TmY13', 'TmY5a'),
 ('TmY14', 'C3'),
 ('TmY14', 'Mi12'),
 ('TmY14', 'Mi13'),
 ('TmY14', 'Tm9'),
 ('TmY14', 'Tm16'),
 ('TmY14', 'TmY4'),
 ('TmY15', 'Mi4'),
 ('TmY15', 'Mi9'),
 ('TmY15', 'T2'),
 ('TmY15', 'T2a'),
 ('TmY15', 'T4a'),
 ('TmY15', 'T4b'),
 ('TmY15', 'T4c'),
 ('TmY15', 'T4d'),
 ('TmY15', 'T5a'),
 ('TmY15', 'T5b'),
 ('TmY15', 'T5c'),
 ('TmY15', 'T5d'),
 ('TmY15', 'Tm1'),
 ('TmY15', 'Tm2'),
 ('TmY15', 'Tm3'),
 ('TmY15', 'Tm4'),
 ('TmY15', 'Tm9'),
 ('TmY15', 'TmY3'),
 ('TmY15', 'TmY14'),
 ('TmY15', 'TmY18'),
 ('TmY18', 'Mi4'),
 ('TmY18', 'Mi10'),
 ('TmY18', 'T2'),
 ('TmY18', 'TmY5a'),
 ('TmY18', 'TmY9'),
 ('TmY18', 'TmY15'),
 ('TmY18', 'TmY18')]
</code></pre>
<pre><code class="language-python">from flyvision.utils.tensor_utils import matrix_mask_by_sub, where_equal_rows
</code></pre>
<pre><code class="language-python">keys = np.array(param2.keys)
</code></pre>
<pre><code class="language-python">keys[matrix_mask_by_sub(np.array([(&quot;R4&quot;, &quot;Am&quot;), (&quot;Mi9&quot;, &quot;T4a&quot;)]), np.array(param2.keys))]
</code></pre>
<pre><code>array([['R4', 'Am'],
       ['Mi9', 'T4a']], dtype='&lt;U8')
</code></pre>
<pre><code class="language-python">matrix_mask_by_sub(np.array([(&quot;R4&quot;, &quot;Am&quot;), (&quot;Mi9&quot;, &quot;T4a&quot;)]), np.array(param2.keys))
</code></pre>
<pre><code>array([False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
        True, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False,  True, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False, False, False,
       False])
</code></pre>
<pre><code class="language-python">np.array([(&quot;R4&quot;, &quot;Am&quot;), (&quot;Mi9&quot;, &quot;T4a&quot;)]).shape
</code></pre>
<pre><code>(2, 2)
</code></pre>
<pre><code class="language-python">np.array(param2.keys).shape
</code></pre>
<pre><code>(65,)
</code></pre>
<pre><code class="language-python">np.array(param2.keys)[where_equal_rows(np.array([(&quot;R4&quot;, &quot;Am&quot;), (&quot;Mi9&quot;, &quot;T4a&quot;)]), np.array(param2.keys))]
</code></pre>
<pre><code>array([['R4', 'Am'],
       ['Mi9', 'T4a']], dtype='&lt;U8')
</code></pre>
<pre><code class="language-python">where_equal_rows??
</code></pre>
<pre><code class="language-python">edges.groupby([&quot;source_type&quot;, &quot;target_type&quot;], sort=False, as_index=False, group_keys=[&quot;source_type&quot;, &quot;target_type&quot;], observed=[&quot;source_type&quot;, &quot;target_type&quot;, &quot;edge_type&quot;]).mean([&quot;n_syn&quot;])
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>source_type</th>
      <th>target_type</th>
      <th>source_u</th>
      <th>target_u</th>
      <th>n_syn</th>
      <th>du</th>
      <th>source_index</th>
      <th>dv</th>
      <th>source_v</th>
      <th>target_index</th>
      <th>target_v</th>
      <th>sign</th>
      <th>n_syn_certainty</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>R1</td>
      <td>L1</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>40.000000</td>
      <td>0.000000</td>
      <td>360.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>6128.000000</td>
      <td>0.000000</td>
      <td>-1.0</td>
      <td>5.859477</td>
    </tr>
    <tr>
      <th>1</th>
      <td>R1</td>
      <td>L2</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>46.000000</td>
      <td>0.000000</td>
      <td>360.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>6849.000000</td>
      <td>0.000000</td>
      <td>-1.0</td>
      <td>5.859477</td>
    </tr>
    <tr>
      <th>2</th>
      <td>R1</td>
      <td>L3</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>11.000000</td>
      <td>0.000000</td>
      <td>360.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>7570.000000</td>
      <td>0.000000</td>
      <td>-1.0</td>
      <td>5.859477</td>
    </tr>
    <tr>
      <th>3</th>
      <td>R1</td>
      <td>Am</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>36.000000</td>
      <td>0.000000</td>
      <td>360.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>9979.000000</td>
      <td>0.000000</td>
      <td>-1.0</td>
      <td>5.859477</td>
    </tr>
    <tr>
      <th>4</th>
      <td>R1</td>
      <td>T1</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>2.000000</td>
      <td>0.000000</td>
      <td>360.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>21515.000000</td>
      <td>0.000000</td>
      <td>-1.0</td>
      <td>5.859477</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>599</th>
      <td>TmY18</td>
      <td>T2</td>
      <td>0.244507</td>
      <td>-0.244507</td>
      <td>2.364281</td>
      <td>-0.489015</td>
      <td>45313.822112</td>
      <td>0.489015</td>
      <td>-0.244507</td>
      <td>22230.177888</td>
      <td>0.244507</td>
      <td>1.0</td>
      <td>1.587606</td>
    </tr>
    <tr>
      <th>600</th>
      <td>TmY18</td>
      <td>TmY5a</td>
      <td>-0.244507</td>
      <td>0.244507</td>
      <td>1.656361</td>
      <td>0.489015</td>
      <td>45302.177888</td>
      <td>-0.489015</td>
      <td>0.244507</td>
      <td>40987.822112</td>
      <td>-0.244507</td>
      <td>1.0</td>
      <td>5.517218</td>
    </tr>
    <tr>
      <th>601</th>
      <td>TmY18</td>
      <td>TmY9</td>
      <td>1.500000</td>
      <td>-1.500000</td>
      <td>1.000000</td>
      <td>-3.000000</td>
      <td>45344.787302</td>
      <td>2.000000</td>
      <td>-1.000000</td>
      <td>41666.212698</td>
      <td>1.000000</td>
      <td>1.0</td>
      <td>2.782612</td>
    </tr>
    <tr>
      <th>602</th>
      <td>TmY18</td>
      <td>TmY15</td>
      <td>-0.220461</td>
      <td>0.220461</td>
      <td>2.230947</td>
      <td>0.440922</td>
      <td>45302.296781</td>
      <td>0.426213</td>
      <td>-0.213107</td>
      <td>44592.703219</td>
      <td>0.213107</td>
      <td>1.0</td>
      <td>0.864511</td>
    </tr>
    <tr>
      <th>603</th>
      <td>TmY18</td>
      <td>TmY18</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.292609</td>
      <td>0.000000</td>
      <td>45308.099109</td>
      <td>-0.198219</td>
      <td>0.099109</td>
      <td>45307.900891</td>
      <td>-0.099109</td>
      <td>1.0</td>
      <td>2.239571</td>
    </tr>
  </tbody>
</table>
<p>604 rows × 13 columns</p>
</div>
<pre><code class="language-python">Parameter.__subclasses__()
</code></pre>
<pre><code>[flyvision.initialization.RestingPotential,
 flyvision.initialization.TimeConstant,
 flyvision.initialization.SynapseSign,
 flyvision.initialization.SynapseCount,
 flyvision.initialization.SynapseCountScaling,
 __main__.RestingPotentialv2,
 __main__.RestingPotentialv2,
 __main__.RestingPotentialv2,
 __main__.TimeConstantv2,
 __main__.TimeConstantv2,
 __main__.TimeConstantv2]
</code></pre>
<pre><code class="language-python">class A:
    pass
</code></pre>
<pre><code class="language-python">class B(A):
    pass
</code></pre>
<pre><code class="language-python">for cls in Parameter.__subclasses__():
    cls.__bases__ = (B,)
</code></pre>
<pre><code class="language-python">Parameter.__subclasses__()
</code></pre>
<pre><code>[]
</code></pre>
<pre><code class="language-python">from flyvision import results_dir
from flyvision.ensemble import EnsembleView, EnsembleDir
</code></pre>
<pre><code class="language-python">ensemble = EnsembleDir(results_dir / &quot;opticflow/000&quot;)
</code></pre>
<pre><code class="language-python">old_config = Namespace(
  type = 'NetworkDir',
  network = Namespace(
    connectome = Namespace(
      type = 'ConnectomeDir',
      file = 'fib25-fib19_v2.2.json',
      extent = 15,
      n_syn_fill = 1
    ),
    dynamics = Namespace(
      type = 'PPNeuronIGRSynapses',
      activation = Namespace(type='relu')
    ),
    node_config = Namespace(
      bias = Namespace(
        type = 'RestingPotential',
        keys = ['type'],
        initial_dist = 'Normal',
        mode = 'sample',
        requires_grad = True,
        mean = 0.5,
        std = 0.05,
        penalize = Namespace(activity=True),
        seed = 0
      ),
      time_const = Namespace(
        type = 'TimeConstant',
        keys = ['type'],
        initial_dist = 'Value',
        value = 0.05,
        requires_grad = True
      )
    ),
    edge_config = Namespace(
      sign = Namespace(
        type = 'SynapseSign',
        initial_dist = 'Value',
        requires_grad = False
      ),
      syn_count = Namespace(
        type = 'SynapseCount',
        initial_dist = 'Lognormal',
        mode = 'mean',
        requires_grad = False,
        std = 1.0
      ),
      syn_strength = Namespace(
        type = 'SynapseCountScaling',
        initial_dist = 'Value',
        requires_grad = True,
        scale_elec = 0.01,
        scale_chem = 0.01,
        clamp = 'non_negative'
      )
    )
  ),
  task_dataset = Namespace(
    type = 'MultiTaskSintel',
    tasks = ['flow'],
    n_frames = 19,
    dt_sampling = True,
    interpolate = True,
    boxfilter = Namespace(extent=15, kernel_size=13),
    vertical_splits = 3,
    p_flip = 0.5,
    p_rot = 0.5,
    contrast = 0.2,
    brightness = 0.1,
    noise = 0.08,
    cache = 'gpu',
    gamma = 1.0
  ),
  task_decoder = Namespace(
    type = 'DecoderGAVP',
    shape = [8, 2],
    kernel_size = 5,
    const_weight = 0.001,
    n_out_features = None,
    p_dropout = 0.5
  ),
  task_loss = Namespace(type='mean_root_norm')
)
</code></pre>
<pre><code class="language-python">new_config = Namespace(
  type = 'NetworkDir',
  network = Namespace(
    connectome = Namespace(
      type = 'ConnectomeDir',
      file = 'fib25-fib19_v2.2.json',
      extent = 15,
      n_syn_fill = 1
    ),
    dynamics = Namespace(
      type = 'PPNeuronIGRSynapses',
      activation = Namespace(type='relu')
    ),
    node_config = Namespace(
      bias = Namespace(
        type = 'RestingPotential',
        groupby=[&quot;type&quot;],
        initial_dist = 'Normal',
        mode = 'sample',
        requires_grad = True,
        mean = 0.5,
        std = 0.05,
        penalize = Namespace(activity=True),
        seed = 0
      ),
      time_const = Namespace(
        type = 'TimeConstant',
        groupby=[&quot;type&quot;],
        initial_dist = 'Value',
        value = 0.05,
        requires_grad = True
      )
    ),
    edge_config = Namespace(
      sign = Namespace(
        type = 'SynapseSign',
        initial_dist = 'Value',
        requires_grad = False,
        groupby=[&quot;source_type&quot;, &quot;target_type&quot;],
      ),
      syn_count = Namespace(
        type = 'SynapseCount',
        initial_dist = 'Lognormal',
        mode = 'mean',
        requires_grad = False,
        std = 1.0,
        groupby=[&quot;source_type&quot;, &quot;target_type&quot;, &quot;du&quot;, &quot;dv&quot;],
      ),
      syn_strength = Namespace(
        type = 'SynapseCountScaling',
        initial_dist = 'Value',
        requires_grad = True,
        scale_elec = 0.01,
        scale_chem = 0.01,
        clamp = 'non_negative',
        groupby=[&quot;source_type&quot;, &quot;target_type&quot;, &quot;edge_type&quot;],
      )
    )
  ),
  task_dataset = Namespace(
    type = 'MultiTaskSintel',
    tasks = ['flow'],
    n_frames = 19,
    dt_sampling = True,
    interpolate = True,
    boxfilter = Namespace(extent=15, kernel_size=13),
    vertical_splits = 3,
    p_flip = 0.5,
    p_rot = 0.5,
    contrast = 0.2,
    brightness = 0.1,
    noise = 0.08,
    cache = 'gpu',
    gamma = 1.0
  ),
  task_decoder = Namespace(
    type = 'DecoderGAVP',
    shape = [8, 2],
    kernel_size = 5,
    const_weight = 0.001,
    n_out_features = None,
    p_dropout = 0.5
  ),
  task_loss = Namespace(type='norm')
)
</code></pre>
<pre><code class="language-python">config = None
for name, _dir in ensemble.items():
    if name.isnumeric():
        print(name)
        if config is None:
            config = _dir.config
        assert _dir.config == config
        _dir._override_config(new_config)
</code></pre>
<pre><code>0003
0004
0032
0035
0034
0033
0005
0002
0020
0018
0027
0011
0029
0016
0042
0045
0028
0017
0010
0019
0026
0021
0044
0043
0007
0038
0000
0036
0009
0031
0030
0037
0008
0001
0006
0039
0046
0041
0048
0024
0023
0015
0012
0049
0040
0047
0013
0014
0022
0025


/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
/var/folders/b1/s01d0fxj4r56mc22xx01vnd9c7405m/T/ipykernel_70259/2707961450.py:8: ConfigWarning: Overriding config. Diff is:Namespace(
  passed = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type', 'edge_type']"
  ],
  stored = [
    "≠network.edge_config.syn_strength.groupby: ['source_type', 'target_type']"
  ]
)
  _dir._override_config(new_config)
</code></pre>
<pre><code class="language-python">_dir._override_config()
</code></pre>
<pre><code>0025/ - Last modified: March 23, 2023 11:22:29
├── _meta.yaml
├── best_chkpt
└── validation_loss.h5

displaying: 1 directory, 3 files
</code></pre>
<pre><code class="language-python">x = np.arange(10)
</code></pre>
<pre><code class="language-python">x[slice(-1, -2, -1)]
</code></pre>
<pre><code>array([9])
</code></pre>
<pre><code class="language-python">x.tolist()[slice(-1, -1, -1)]
</code></pre>
<pre><code>[]
</code></pre>
<pre><code class="language-python">
</code></pre>
<pre><code>slice(-1, -2, -1)
</code></pre>
<pre><code class="language-python">import wget
</code></pre>
<pre><code>---------------------------------------------------------------------------

ModuleNotFoundError                       Traceback (most recent call last)

Input In [164], in &lt;cell line: 1&gt;()
----&gt; 1 import wget


ModuleNotFoundError: No module named 'wget'
</code></pre>
<pre><code class="language-python">import tqdm
</code></pre>
<pre><code class="language-python">
</code></pre>













              </article>
            </div>


<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>

      </main>

        <footer class="md-footer">

  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">


    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>

</div>

    </div>
  </div>
</footer>

    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>


    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>


      <script src="../../assets/javascripts/bundle.d6f25eb3.min.js"></script>

        <script src="../../javascripts/switch-logo.js"></script>


  </body>
</html>
